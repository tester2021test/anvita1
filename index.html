<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Fun Match 100</title>
<style>
  /* --- RESET & LAYOUT --- */
  body {
    margin: 0;
    padding: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
    font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
    touch-action: none; /* KEY: Disables browser zooming/scrolling */
    display: flex;
    flex-direction: column;
    align-items: center;
    user-select: none;
  }

  /* --- HEADER & HUD --- */
  header {
    width: 90%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    z-index: 10;
  }
  
  h1 {
    margin: 0;
    font-size: 1.2rem;
    color: #fff;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }

  .score-board {
    background: rgba(255, 255, 255, 0.3);
    padding: 5px 15px;
    border-radius: 20px;
    font-weight: bold;
    color: #fff;
    backdrop-filter: blur(5px);
  }

  /* --- GAME AREA --- */
  .game-area {
    flex: 1;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-evenly; /* Spreads top and bottom rows */
    align-items: center;
    position: relative;
  }

  /* --- ROW STYLES --- */
  .row {
    display: flex;
    justify-content: space-evenly; /* Even spacing for 3 items */
    width: 100%;
    padding: 0 10px;
    box-sizing: border-box;
  }

  /* --- TARGETS (TOP) --- */
  .target {
    width: 28vw;  /* Responsive size: fits 3 in a row */
    height: 28vw;
    max-width: 130px;
    max-height: 130px;
    border: 3px dashed #fff;
    border-radius: 15px;
    background-color: rgba(255,255,255,0.25);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 3.5rem; /* Large Emoji */
    opacity: 0.6; /* Ghost look */
    transition: transform 0.2s, background-color 0.2s;
  }

  .target.highlight {
    background-color: rgba(255, 255, 255, 0.6);
    transform: scale(1.05);
    border-style: solid;
  }

  .target.matched {
    border: 4px solid #4CAF50;
    background-color: #fff;
    opacity: 1;
    transform: scale(1.1);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  /* --- DRAGGABLES (BOTTOM) --- */
  /* Placeholder slots to keep spacing */
  .slot {
    width: 25vw;
    height: 25vw;
    max-width: 110px;
    max-height: 110px;
    background: rgba(0,0,0,0.05);
    border-radius: 50%;
  }

  /* The actual draggable item */
  .item {
    width: 25vw;
    height: 25vw;
    max-width: 110px;
    max-height: 110px;
    background: white;
    border-radius: 50%;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 4rem;
    position: absolute; /* Vital for free movement */
    z-index: 100;
    cursor: grab;
    touch-action: none;
  }

  .item:active {
    cursor: grabbing;
    transform: scale(1.1);
  }

  /* --- OVERLAYS --- */
  #level-msg {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(0);
    background: white;
    padding: 30px 50px;
    border-radius: 25px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.3);
    font-size: 2.5rem;
    z-index: 2000;
    text-align: center;
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  
  #level-msg.show {
    transform: translate(-50%, -50%) scale(1);
  }

  canvas {
    position: fixed;
    top: 0; left: 0;
    pointer-events: none;
    z-index: 1500;
  }

  @keyframes pop {
    0% { transform: scale(0.8); }
    100% { transform: scale(1.1); }
  }
</style>
</head>
<body>

  <header>
    <h1>Match 3!</h1>
    <div class="score-board">Score: <span id="score">0</span></div>
  </header>

  <div class="game-area">
    <div class="row" id="targets-container"></div>
    
    <div class="row" id="slots-container"></div>
  </div>

  <div id="level-msg">Awesome! ðŸŒŸ</div>
  <canvas id="confetti"></canvas>

<script>
/* --------------------------------------------------
   1. HUGE DATASET (100+ ITEMS)
   --------------------------------------------------
*/
const DATA = [
  // Animals
  {id:'lion', i:'ðŸ¦'}, {id:'tiger', i:'ðŸ¯'}, {id:'monkey', i:'ðŸµ'}, {id:'dog', i:'ðŸ¶'}, 
  {id:'cat', i:'ðŸ±'}, {id:'fox', i:'ðŸ¦Š'}, {id:'bear', i:'ðŸ»'}, {id:'panda', i:'ðŸ¼'}, 
  {id:'koala', i:'ðŸ¨'}, {id:'cow', i:'ðŸ®'}, {id:'pig', i:'ðŸ·'}, {id:'frog', i:'ðŸ¸'}, 
  {id:'octopus', i:'ðŸ™'}, {id:'turtle', i:'ðŸ¢'}, {id:'snake', i:'ðŸ'}, {id:'whale', i:'ðŸ³'}, 
  {id:'dolphin', i:'ðŸ¬'}, {id:'fish', i:'ðŸ '}, {id:'butterfly', i:'ðŸ¦‹'}, {id:'bee', i:'ðŸ'},
  {id:'owl', i:'ðŸ¦‰'}, {id:'duck', i:'ðŸ¦†'}, {id:'flamingo', i:'ðŸ¦©'}, {id:'parrot', i:'ðŸ¦œ'},
  {id:'unicorn', i:'ðŸ¦„'}, {id:'rabbit', i:'ðŸ°'}, {id:'mouse', i:'ðŸ­'}, {id:'hamster', i:'ðŸ¹'},

  // Food
  {id:'apple', i:'ðŸŽ'}, {id:'pear', i:'ðŸ'}, {id:'orange', i:'ðŸŠ'}, {id:'lemon', i:'ðŸ‹'}, 
  {id:'banana', i:'ðŸŒ'}, {id:'watermelon', i:'ðŸ‰'}, {id:'grapes', i:'ðŸ‡'}, {id:'strawberry', i:'ðŸ“'}, 
  {id:'cherry', i:'ðŸ’'}, {id:'peach', i:'ðŸ‘'}, {id:'pineapple', i:'ðŸ'}, {id:'kiwi', i:'ðŸ¥'}, 
  {id:'tomato', i:'ðŸ…'}, {id:'avocado', i:'ðŸ¥‘'}, {id:'carrot', i:'ðŸ¥•'}, {id:'corn', i:'ðŸŒ½'}, 
  {id:'pepper', i:'ðŸŒ¶ï¸'}, {id:'bread', i:'ðŸž'}, {id:'croissant', i:'ðŸ¥'}, {id:'cheese', i:'ðŸ§€'}, 
  {id:'egg', i:'ðŸ¥š'}, {id:'pizza', i:'ðŸ•'}, {id:'burger', i:'ðŸ”'}, {id:'fries', i:'ðŸŸ'}, 
  {id:'hotdog', i:'ðŸŒ­'}, {id:'popcorn', i:'ðŸ¿'}, {id:'donut', i:'ðŸ©'}, {id:'cookie', i:'ðŸª'}, 
  {id:'cake', i:'ðŸ°'}, {id:'choco', i:'ðŸ«'}, {id:'candy', i:'ðŸ¬'}, {id:'icecream', i:'ðŸ¦'},

  // Vehicles
  {id:'car', i:'ðŸš—'}, {id:'taxi', i:'ðŸš•'}, {id:'bus', i:'ðŸšŒ'}, {id:'police', i:'ðŸš“'}, 
  {id:'ambulance', i:'ðŸš‘'}, {id:'fire', i:'ðŸš’'}, {id:'truck', i:'ðŸšš'}, {id:'tractor', i:'ðŸšœ'}, 
  {id:'scooter', i:'ðŸ›µ'}, {id:'bike', i:'ðŸš²'}, {id:'train', i:'ðŸš‚'}, {id:'rocket', i:'ðŸš€'}, 
  {id:'ufo', i:'ðŸ›¸'}, {id:'helicopter', i:'ðŸš'}, {id:'boat', i:'â›µ'}, {id:'ship', i:'ðŸš¢'},

  // Nature & Objects
  {id:'sun', i:'â˜€ï¸'}, {id:'moon', i:'ðŸŒ™'}, {id:'star', i:'â­'}, {id:'rainbow', i:'ðŸŒˆ'}, 
  {id:'cloud', i:'â˜ï¸'}, {id:'fire', i:'ðŸ”¥'}, {id:'tree', i:'ðŸŒ²'}, {id:'cactus', i:'ðŸŒµ'}, 
  {id:'flower', i:'ðŸŒ»'}, {id:'rose', i:'ðŸŒ¹'}, {id:'tulip', i:'ðŸŒ·'}, {id:'palm', i:'ðŸŒ´'},
  {id:'ball', i:'âš½'}, {id:'basket', i:'ðŸ€'}, {id:'football', i:'ðŸˆ'}, {id:'tennis', i:'ðŸŽ¾'}, 
  {id:'balloon', i:'ðŸŽˆ'}, {id:'gift', i:'ðŸŽ'}, {id:'trophy', i:'ðŸ†'}, {id:'crown', i:'ðŸ‘‘'}, 
  {id:'gem', i:'ðŸ’Ž'}, {id:'bell', i:'ðŸ””'}, {id:'music', i:'ðŸŽµ'}, {id:'camera', i:'ðŸ“·'},
  {id:'phone', i:'ðŸ“±'}, {id:'tv', i:'ðŸ“º'}, {id:'bulb', i:'ðŸ’¡'}, {id:'book', i:'ðŸ“š'}
];

/* --------------------------------------------------
   2. GAME STATE
   --------------------------------------------------
*/
let score = 0;
let matchesLeft = 0;
const ITEMS_PER_LEVEL = 3; // Difficulty setting

// Audio Context (Safe Init)
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

/* --------------------------------------------------
   3. INIT & LEVEL GENERATION
   --------------------------------------------------
*/
function initLevel() {
  const targetsDiv = document.getElementById('targets-container');
  const slotsDiv = document.getElementById('slots-container');
  const msgDiv = document.getElementById('level-msg');
  
  // Cleanup
  targetsDiv.innerHTML = '';
  slotsDiv.innerHTML = '';
  msgDiv.classList.remove('show');
  
  // 1. Pick 3 Random Items
  const shuffledData = [...DATA].sort(() => 0.5 - Math.random());
  const levelItems = shuffledData.slice(0, ITEMS_PER_LEVEL);
  matchesLeft = ITEMS_PER_LEVEL;

  // 2. Create Targets (Top Row)
  levelItems.forEach(item => {
    const t = document.createElement('div');
    t.className = 'target';
    t.id = `target-${item.id}`;
    t.innerText = item.i; // The emoji ghost
    targetsDiv.appendChild(t);
  });

  // 3. Create Draggables (Bottom Row) - Shuffled!
  const dragItems = [...levelItems].sort(() => 0.5 - Math.random());
  
  dragItems.forEach(item => {
    // Create Slot (Invisible holder for spacing)
    const slot = document.createElement('div');
    slot.className = 'slot';
    slotsDiv.appendChild(slot);

    // Create Item
    const drag = document.createElement('div');
    drag.className = 'item';
    drag.id = `drag-${item.id}`;
    drag.dataset.id = item.id;
    drag.innerText = item.i;

    // Position initial logic
    // We append to body to ensure it floats over everything, 
    // but we need to calculate where the slot is first.
    document.body.appendChild(drag);
    
    // Set position to match the slot
    const rect = slot.getBoundingClientRect();
    drag.style.left = rect.left + 'px';
    drag.style.top = rect.top + 'px';
    drag.dataset.homeX = rect.left;
    drag.dataset.homeY = rect.top;

    // Attach Touch/Mouse Logic
    makeDraggable(drag);
  });
}

/* --------------------------------------------------
   4. DRAG & DROP LOGIC (Robust for Mobile)
   --------------------------------------------------
*/
function makeDraggable(el) {
  let isDragging = false;

  function onStart(e) {
    if(e.type === 'touchstart') e.preventDefault(); // Stop Scroll
    isDragging = true;
    
    // Resume audio context on first user interaction
    if(audioCtx.state === 'suspended') audioCtx.resume();

    // Visual Pop
    el.style.transition = 'none'; // No lag when dragging
    el.style.zIndex = 1000;
    el.style.transform = "scale(1.2)";

    moveAt(e);
  }

  function onMove(e) {
    if (!isDragging) return;
    if(e.type === 'touchmove') e.preventDefault(); // Stop Scroll
    moveAt(e);
    
    // Highlight logic
    const target = document.getElementById(`target-${el.dataset.id}`);
    if (target && isColliding(el, target)) {
      target.classList.add('highlight');
    } else {
      // Remove highlight from all if not near
      document.querySelectorAll('.target').forEach(t => t.classList.remove('highlight'));
    }
  }

  function onEnd(e) {
    if (!isDragging) return;
    isDragging = false;
    
    el.style.zIndex = 100;
    el.style.transform = "scale(1)";
    
    const target = document.getElementById(`target-${el.dataset.id}`);
    
    // Check Collision
    if (target && isColliding(el, target)) {
      handleMatch(el, target);
    } else {
      // Return to home
      returnToHome(el);
      document.querySelectorAll('.target').forEach(t => t.classList.remove('highlight'));
    }
  }

  function moveAt(e) {
    const pageX = e.touches ? e.touches[0].pageX : e.pageX;
    const pageY = e.touches ? e.touches[0].pageY : e.pageY;
    
    // Offset so finger doesn't cover the item completely
    el.style.left = (pageX - el.offsetWidth / 2) + 'px';
    el.style.top = (pageY - el.offsetHeight / 2 - 50) + 'px'; 
  }

  // Event Listeners
  el.addEventListener('mousedown', onStart);
  el.addEventListener('touchstart', onStart, {passive: false});

  // Global listeners for move/end to prevent losing the drag if moving fast
  window.addEventListener('mousemove', onMove, {passive: false});
  window.addEventListener('touchmove', onMove, {passive: false});
  
  window.addEventListener('mouseup', onEnd);
  window.addEventListener('touchend', onEnd);
}

function isColliding(el1, el2) {
  const r1 = el1.getBoundingClientRect();
  const r2 = el2.getBoundingClientRect();
  const dist = Math.hypot(
    (r1.left + r1.width/2) - (r2.left + r2.width/2),
    (r1.top + r1.height/2) - (r2.top + r2.height/2)
  );
  return dist < 80; // Collision threshold
}

function returnToHome(el) {
  el.style.transition = "all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
  el.style.left = el.dataset.homeX + 'px';
  el.style.top = el.dataset.homeY + 'px';
}

function handleMatch(el, target) {
  // Snap visuals
  const rect = target.getBoundingClientRect();
  el.style.transition = "all 0.2s ease";
  el.style.left = rect.left + 'px';
  el.style.top = rect.top + 'px';
  el.style.opacity = '0'; // Hide drag item, show matched target

  target.classList.remove('highlight');
  target.classList.add('matched'); // Turns solid and pops

  // Sound & FX
  playPopSound();
  spawnConfetti(rect.left + rect.width/2, rect.top + rect.height/2, 15);
  
  // Cleanup drag item after anim
  setTimeout(() => el.remove(), 200);

  matchesLeft--;
  if (matchesLeft === 0) {
    levelComplete();
  }
}

function levelComplete() {
  score += 10;
  document.getElementById('score').innerText = score;
  
  spawnConfetti(window.innerWidth/2, window.innerHeight/2, 100);
  playWinSound();

  const msg = document.getElementById('level-msg');
  msg.classList.add('show');

  setTimeout(() => {
    initLevel();
  }, 2000);
}

/* --------------------------------------------------
   5. AUDIO & VISUAL FX
   --------------------------------------------------
*/
function playPopSound() {
  const osc = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  osc.connect(g); g.connect(audioCtx.destination);
  
  osc.frequency.setValueAtTime(500, audioCtx.currentTime);
  osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
  
  g.gain.setValueAtTime(0.1, audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
  
  osc.start(); osc.stop(audioCtx.currentTime + 0.1);
}

function playWinSound() {
  const now = audioCtx.currentTime;
  // Simple Major Chord Arpeggio
  [440, 554, 659].forEach((freq, i) => {
    const osc = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    osc.connect(g); g.connect(audioCtx.destination);
    
    osc.frequency.value = freq;
    g.gain.setValueAtTime(0, now + i*0.1);
    g.gain.linearRampToValueAtTime(0.1, now + i*0.1 + 0.05);
    g.gain.exponentialRampToValueAtTime(0.001, now + i*0.1 + 0.4);
    
    osc.start(now + i*0.1); 
    osc.stop(now + i*0.1 + 0.4);
  });
}

// Simple Confetti Engine
const canvas = document.getElementById('confetti');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let particles = [];

function spawnConfetti(x, y, amount) {
  const colors = ['#ff0', '#f00', '#0f0', '#00f', '#f0f', '#0ff'];
  for(let i=0; i<amount; i++) {
    particles.push({
      x: x, y: y,
      vx: (Math.random()-0.5) * 15,
      vy: (Math.random()-0.5) * 15,
      grav: 0.5,
      life: 60 + Math.random()*30,
      color: colors[Math.floor(Math.random()*colors.length)]
    });
  }
}

function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=particles.length-1; i>=0; i--) {
    let p = particles[i];
    p.x += p.vx;
    p.y += p.vy;
    p.vy += p.grav; // Gravity
    p.life--;
    
    ctx.fillStyle = p.color;
    ctx.fillRect(p.x, p.y, 8, 8);
    
    if(p.life <= 0) particles.splice(i, 1);
  }
  requestAnimationFrame(loop);
}
loop();

// Handle Resize
window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  // If we resize, items might be out of place, so we restart level for simplicity
  initLevel();
});

// START
initLevel();

</script>
</body>
</html>
