<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Match & Learn</title>
<style>
  /* --- RESET & LAYOUT --- */
  body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100vh;
    overflow: hidden;
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
    touch-action: none;
    display: flex;
    flex-direction: column;
    user-select: none;
    -webkit-user-select: none;
  }

  /* --- HEADER --- */
  header {
    height: 10%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
  }
  
  h1 { font-size: 1.2rem; color: #444; margin: 0; text-shadow: 1px 1px 0 #fff; }
  .score-board { 
    background: white; padding: 5px 15px; 
    border-radius: 15px; font-weight: bold; color: #333; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

  /* --- GAME AREA --- */
  .game-area {
    height: 90%;
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
    align-items: center;
    padding-bottom: 20px;
  }

  .row {
    display: flex;
    justify-content: center;
    gap: 15px;
    width: 100%;
  }

  /* --- TARGETS (Top Boxes) --- */
  .target-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
  }

  .target {
    width: 28vw; height: 28vw;
    max-width: 110px; max-height: 110px;
    border: 3px dashed #777;
    border-radius: 15px;
    background-color: rgba(255,255,255,0.4);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 3rem;
    opacity: 0.5;
    transition: transform 0.2s;
  }
  
  .target.highlight { background: #fff; transform: scale(1.1); border-color: #333; }
  
  .target.matched { 
    border: 3px solid #4CAF50; background: white; opacity: 1; 
    transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }

  /* Label that appears on match */
  .name-label {
    margin-top: 5px;
    font-size: 0.9rem;
    font-weight: bold;
    color: #333;
    opacity: 0;
    transition: opacity 0.3s;
    background: rgba(255,255,255,0.8);
    padding: 2px 8px;
    border-radius: 10px;
  }
  .name-label.show { opacity: 1; }

  /* --- SLOTS & ITEMS (Bottom Circles) --- */
  .slot {
    width: 26vw; height: 26vw;
    max-width: 100px; max-height: 100px;
    background: rgba(0,0,0,0.1);
    border-radius: 50%;
    position: relative; 
  }

  .item {
    width: 100%; height: 100%;
    position: absolute; 
    top: 0; left: 0;
    background: white;
    border-radius: 50%;
    box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 3.5rem;
    cursor: grab;
    z-index: 10;
  }

  .item.dragging {
    position: fixed; 
    z-index: 1000;
    pointer-events: none; 
    box-shadow: 0 15px 30px rgba(0,0,0,0.3);
    transform: scale(1.2);
  }

  /* --- POPUP --- */
  #level-msg {
    position: fixed; top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(0);
    background: white; padding: 20px 40px;
    border-radius: 20px; font-size: 2rem;
    box-shadow: 0 0 50px rgba(0,0,0,0.2);
    z-index: 2000; transition: transform 0.3s;
    text-align: center;
  }
  #level-msg.show { transform: translate(-50%, -50%) scale(1); }
  
  canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1500; }
</style>
</head>
<body>

  <header>
    <h1>Match & Learn</h1>
    <div class="score-board">Score: <span id="score">0</span></div>
  </header>

  <div class="game-area">
    <div class="row" id="targets-container"></div>
    
    <div class="row" id="slots-container"></div>
  </div>

  <div id="level-msg">Good Job! ðŸŽ‰</div>
  <canvas id="confetti"></canvas>

<script>
/* --------------------------------------------------
   1. DATA WITH NAMES (n = Name)
   -------------------------------------------------- */
const DATA = [
  {id:'lion', i:'ðŸ¦', n:'Lion'}, {id:'dog', i:'ðŸ¶', n:'Dog'}, 
  {id:'cat', i:'ðŸ±', n:'Cat'}, {id:'bear', i:'ðŸ»', n:'Bear'}, 
  {id:'panda', i:'ðŸ¼', n:'Panda'}, {id:'pig', i:'ðŸ·', n:'Pig'}, 
  {id:'frog', i:'ðŸ¸', n:'Frog'}, {id:'octopus', i:'ðŸ™', n:'Octopus'}, 
  {id:'turtle', i:'ðŸ¢', n:'Turtle'}, {id:'bee', i:'ðŸ', n:'Bee'},
  {id:'apple', i:'ðŸŽ', n:'Apple'}, {id:'banana', i:'ðŸŒ', n:'Banana'}, 
  {id:'grapes', i:'ðŸ‡', n:'Grapes'}, {id:'pizza', i:'ðŸ•', n:'Pizza'}, 
  {id:'burger', i:'ðŸ”', n:'Burger'}, {id:'car', i:'ðŸš—', n:'Car'}, 
  {id:'bus', i:'ðŸšŒ', n:'Bus'}, {id:'rocket', i:'ðŸš€', n:'Rocket'}, 
  {id:'ship', i:'ðŸš¢', n:'Ship'}, {id:'train', i:'ðŸš‚', n:'Train'},
  {id:'sun', i:'â˜€ï¸', n:'Sun'}, {id:'moon', i:'ðŸŒ™', n:'Moon'}, 
  {id:'star', i:'â­', n:'Star'}, {id:'ball', i:'âš½', n:'Soccer Ball'}, 
  {id:'flower', i:'ðŸŒ»', n:'Flower'}, {id:'fox', i:'ðŸ¦Š', n:'Fox'}, 
  {id:'mouse', i:'ðŸ­', n:'Mouse'}, {id:'bunny', i:'ðŸ°', n:'Bunny'}, 
  {id:'koala', i:'ðŸ¨', n:'Koala'}, {id:'tiger', i:'ðŸ¯', n:'Tiger'},
  {id:'cow', i:'ðŸ®', n:'Cow'}, {id:'chick', i:'ðŸ¤', n:'Chick'}, 
  {id:'whale', i:'ðŸ³', n:'Whale'}, {id:'fish', i:'ðŸ ', n:'Fish'}, 
  {id:'crab', i:'ðŸ¦€', n:'Crab'}, {id:'corn', i:'ðŸŒ½', n:'Corn'}, 
  {id:'carrot', i:'ðŸ¥•', n:'Carrot'}, {id:'fries', i:'ðŸŸ', n:'French Fries'}, 
  {id:'egg', i:'ðŸ¥š', n:'Egg'}, {id:'cookie', i:'ðŸª', n:'Cookie'},
  {id:'choco', i:'ðŸ«', n:'Chocolate'}, {id:'candy', i:'ðŸ¬', n:'Candy'}, 
  {id:'cake', i:'ðŸ°', n:'Cake'}, {id:'donut', i:'ðŸ©', n:'Donut'}, 
  {id:'ice', i:'ðŸ¦', n:'Ice Cream'}, {id:'police', i:'ðŸš“', n:'Police Car'}, 
  {id:'fire', i:'ðŸš’', n:'Fire Truck'}, {id:'taxi', i:'ðŸš•', n:'Taxi'}, 
  {id:'bike', i:'ðŸš²', n:'Bicycle'}, {id:'plane', i:'âœˆï¸', n:'Airplane'},
  {id:'tree', i:'ðŸŒ²', n:'Tree'}, {id:'leaf', i:'ðŸ', n:'Leaf'}, 
  {id:'rose', i:'ðŸŒ¹', n:'Rose'}, {id:'cactus', i:'ðŸŒµ', n:'Cactus'}, 
  {id:'palm', i:'ðŸŒ´', n:'Palm Tree'}, {id:'gift', i:'ðŸŽ', n:'Gift'}, 
  {id:'bell', i:'ðŸ””', n:'Bell'}, {id:'music', i:'ðŸŽµ', n:'Music'}, 
  {id:'heart', i:'â¤ï¸', n:'Heart'}, {id:'gem', i:'ðŸ’Ž', n:'Diamond'},
  {id:'book', i:'ðŸ“š', n:'Book'}, {id:'bulb', i:'ðŸ’¡', n:'Light Bulb'}, 
  {id:'phone', i:'ðŸ“±', n:'Phone'}, {id:'tv', i:'ðŸ“º', n:'TV'}
];

// --- STATE ---
let score = 0;
let matchesLeft = 0;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
const synth = window.speechSynthesis; // Speech Engine

// --- SPEECH HELPER ---
function speak(text, rate = 1) {
  // Cancel any current speech so it doesn't lag
  if(synth.speaking) synth.cancel();
  
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.rate = rate; // Speed: 1 is normal
  utterance.pitch = 1.1; // Slightly higher pitch sounds friendlier
  utterance.lang = 'en-US';
  synth.speak(utterance);
}

// --- INIT LEVEL ---
function initLevel() {
  const targetsDiv = document.getElementById('targets-container');
  const slotsDiv = document.getElementById('slots-container');
  const msgDiv = document.getElementById('level-msg');
  
  targetsDiv.innerHTML = '';
  slotsDiv.innerHTML = '';
  msgDiv.classList.remove('show');
  
  // Pick 3 random
  const shuffled = [...DATA].sort(() => 0.5 - Math.random());
  const levelItems = shuffled.slice(0, 3);
  matchesLeft = 3;

  // 1. Create Targets
  levelItems.forEach(item => {
    // Wrapper for Target + Name Label
    const container = document.createElement('div');
    container.className = 'target-container';

    const t = document.createElement('div');
    t.className = 'target';
    t.id = `target-${item.id}`;
    t.innerText = item.i; // Ghost Emoji
    
    const label = document.createElement('div');
    label.className = 'name-label';
    label.id = `label-${item.id}`;
    label.innerText = item.n; // Text Name

    container.appendChild(t);
    container.appendChild(label);
    targetsDiv.appendChild(container);
  });

  // 2. Create Slots & Items (Shuffled)
  const dragItems = [...levelItems].sort(() => 0.5 - Math.random());
  
  dragItems.forEach(item => {
    const slot = document.createElement('div');
    slot.className = 'slot';
    
    const drag = document.createElement('div');
    drag.className = 'item';
    drag.id = `drag-${item.id}`;
    drag.dataset.id = item.id;
    drag.dataset.name = item.n; // Store name for speech
    drag.innerText = item.i;

    enableTouchLogic(drag, slot);

    slot.appendChild(drag);
    slotsDiv.appendChild(slot);
  });
}

// --- TOUCH LOGIC ---
function enableTouchLogic(el, homeSlot) {
  
  function onStart(e) {
    e.preventDefault(); 
    if(audioCtx.state === 'suspended') audioCtx.resume();

    // SPEECH: Say the name simply on touch
    speak(el.dataset.name);

    const touch = e.touches ? e.touches[0] : e;
    const rect = el.getBoundingClientRect();
    
    el.style.width = rect.width + 'px';
    el.style.height = rect.height + 'px';
    el.style.left = rect.left + 'px';
    el.style.top = rect.top + 'px';
    el.classList.add('dragging');
    document.body.appendChild(el);
    
    el.dataset.offsetX = touch.clientX - rect.left;
    el.dataset.offsetY = touch.clientY - rect.top;
  }

  function onMove(e) {
    if(!el.classList.contains('dragging')) return;
    e.preventDefault();
    const touch = e.touches ? e.touches[0] : e;
    
    const x = touch.clientX - (parseFloat(el.style.width)/2);
    const y = touch.clientY - (parseFloat(el.style.height)/2) - 50;
    
    el.style.left = x + 'px';
    el.style.top = y + 'px';

    const target = document.getElementById(`target-${el.dataset.id}`);
    if(target && isColliding(el, target)) {
      target.classList.add('highlight');
    } else {
      document.querySelectorAll('.target').forEach(t => t.classList.remove('highlight'));
    }
  }

  function onEnd(e) {
    if(!el.classList.contains('dragging')) return;
    
    const target = document.getElementById(`target-${el.dataset.id}`);
    const isMatch = target && isColliding(el, target);

    if (isMatch) {
      // SUCCESS
      target.classList.remove('highlight');
      target.classList.add('matched');
      
      // SHOW LABEL
      const label = document.getElementById(`label-${el.dataset.id}`);
      if(label) label.classList.add('show');

      // SPEECH: Say "This is a [Name]"
      speak("This is a " + el.dataset.name, 0.9);

      playPop();
      spawnConfetti(target.getBoundingClientRect());
      el.remove(); 
      
      matchesLeft--;
      if(matchesLeft === 0) levelComplete();
    } else {
      // FAIL
      document.querySelectorAll('.target').forEach(t => t.classList.remove('highlight'));
      const homeRect = homeSlot.getBoundingClientRect();
      el.style.transition = 'all 0.3s ease';
      el.style.left = homeRect.left + 'px';
      el.style.top = homeRect.top + 'px';
      el.style.transform = 'scale(1)'; 

      setTimeout(() => {
        el.classList.remove('dragging');
        el.style.transition = '';
        el.style.width = '100%';
        el.style.height = '100%';
        el.style.left = '0';
        el.style.top = '0';
        el.style.position = 'absolute'; 
        homeSlot.appendChild(el);
      }, 300);
    }
  }

  el.addEventListener('touchstart', onStart, {passive:false});
  el.addEventListener('touchmove', onMove, {passive:false});
  el.addEventListener('touchend', onEnd);
  el.addEventListener('mousedown', onStart);
  window.addEventListener('mousemove', onMove);
  window.addEventListener('mouseup', onEnd);
}

function isColliding(el1, el2) {
  const r1 = el1.getBoundingClientRect();
  const r2 = el2.getBoundingClientRect();
  const dist = Math.hypot((r1.left+r1.width/2)-(r2.left+r2.width/2), (r1.top+r1.height/2)-(r2.top+r2.height/2));
  return dist < 60; 
}

function levelComplete() {
  score += 10;
  document.getElementById('score').innerText = score;
  document.getElementById('level-msg').classList.add('show');
  playWin();
  spawnConfetti({left: window.innerWidth/2, top: window.innerHeight/2, width:0, height:0}, 100);
  setTimeout(initLevel, 2500); // Wait a bit longer to hear speech
}

// --- SOUND FX ---
function playPop() {
  const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
  o.connect(g); g.connect(audioCtx.destination);
  o.frequency.value = 600; 
  o.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
  g.gain.setValueAtTime(0.05, audioCtx.currentTime); 
  g.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.1);
  o.start(); o.stop(audioCtx.currentTime + 0.1);
}

function playWin() {
  [400, 500, 600].forEach((f, i) => {
    setTimeout(() => {
      const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
      o.connect(g); g.connect(audioCtx.destination);
      o.frequency.value = f; 
      g.gain.setValueAtTime(0.05, audioCtx.currentTime);
      g.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
      o.start(); o.stop(audioCtx.currentTime + 0.3);
    }, i*100);
  });
}

// Confetti
const cvs = document.getElementById('confetti');
const ctx = cvs.getContext('2d');
cvs.width = window.innerWidth; cvs.height = window.innerHeight;
let parts = [];
function spawnConfetti(rect, count=20) {
  const cx = rect.left + rect.width/2; const cy = rect.top + rect.height/2;
  for(let i=0; i<count; i++) {
    parts.push({x:cx, y:cy, vx:(Math.random()-0.5)*15, vy:(Math.random()-0.5)*15, c:`hsl(${Math.random()*360},100%,50%)`, life:50});
  }
}
function loop() {
  ctx.clearRect(0,0,cvs.width,cvs.height);
  parts.forEach((p, i) => {
    p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life--;
    ctx.fillStyle = p.c; ctx.fillRect(p.x, p.y, 8, 8);
    if(p.life<=0) parts.splice(i,1);
  });
  requestAnimationFrame(loop);
}
loop();
window.addEventListener('resize', () => { cvs.width = window.innerWidth; cvs.height = window.innerHeight; });

// Start
initLevel();
</script>
</body>
</html>
